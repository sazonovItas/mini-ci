// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: events.sql

package psql

import (
	"context"
	"time"

	"github.com/google/uuid"
)

const createTaskEvent = `-- name: CreateTaskEvent :exec
INSERT INTO task_events (task_id, event_type, occured_at, payload) VALUES ($1, $2, $3, $4)
`

type CreateTaskEventParams struct {
	TaskID    uuid.UUID
	EventType string
	OccuredAt time.Time
	Payload   []byte
}

func (q *Queries) CreateTaskEvent(ctx context.Context, arg CreateTaskEventParams) error {
	_, err := q.db.Exec(ctx, createTaskEvent,
		arg.TaskID,
		arg.EventType,
		arg.OccuredAt,
		arg.Payload,
	)
	return err
}

const taskEvent = `-- name: TaskEvent :many
SELECT task_id, event_type, occured_at, payload FROM task_events
WHERE task_id = $1 AND event_type = $2
ORDER BY occured_at DESC
`

type TaskEventParams struct {
	TaskID    uuid.UUID
	EventType string
}

func (q *Queries) TaskEvent(ctx context.Context, arg TaskEventParams) ([]TaskEvent, error) {
	rows, err := q.db.Query(ctx, taskEvent, arg.TaskID, arg.EventType)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []TaskEvent
	for rows.Next() {
		var i TaskEvent
		if err := rows.Scan(
			&i.TaskID,
			&i.EventType,
			&i.OccuredAt,
			&i.Payload,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const taskEvents = `-- name: TaskEvents :many
SELECT task_id, event_type, occured_at, payload FROM task_events
WHERE task_id = $1
ORDER BY occured_at DESC
`

func (q *Queries) TaskEvents(ctx context.Context, taskID uuid.UUID) ([]TaskEvent, error) {
	rows, err := q.db.Query(ctx, taskEvents, taskID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []TaskEvent
	for rows.Next() {
		var i TaskEvent
		if err := rows.Scan(
			&i.TaskID,
			&i.EventType,
			&i.OccuredAt,
			&i.Payload,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
